<project name="org.thechiselgroup.choosel.core" 
         default="dist" basedir=".">

	  <tstamp>
	    <format property="buildtime" pattern="yyyyMMddHHmmss" />
	  </tstamp>

	  <property name="version" value="b${buildtime}" />
	  <!--
	  <property name="version" value="0.1" />
	  -->
	
	  <property name="name" value="choosel.core" />
	  <property name="project-name" value="org.thechiselgroup.choosel.core" />
	  	
	  <property name="dist" location="bin/dist"/>
	  <property name="src" location="src"/>
	  <property name="class-dir" location="war/WEB-INF/classes"/>
	  <property name="app-lib" value="bin/build/lib"/>
		
  	  <typedef resource="org/tigris/subversion/svnant/svnantlib.xml" classpath="svnant.jar" /> 
	
	  <target name="dist"
		  	  description="creates distribution"
		      depends="create-module-jar,create-project-zip" />
		
	  <target name="create-project-zip"
	  	      description="creates zipfile of project"
	  	      depends="prepare">
	  	
	    <zip destfile="${dist}/${name}-${version}-project.zip">
	      <fileset dir="..">
	      	<include name="${project-name}/**" />
	    	<exclude name="${project-name}/bin/**"/>
	    	<exclude name="${project-name}/tomcat/**"/>
	    	<exclude name="${project-name}/war/WEB-INF/classes/**"/>
	      </fileset>
	    </zip> 
	  </target>	
		
	
	  <target name="create-jar"
				description="creates a module jar file for external use">
		 <jar destfile="${dist}/${name}-${version}.jar">
		      <fileset dir="${src}">
		      </fileset>
		      <fileset dir="${class-dir}">
		    	<include name="**/*.class"/>
		      </fileset>
		      <metainf dir=""> 
		    	<include name="LICENSE"/>
		    	<include name="NOTICE"/>
		      </metainf>
		 </jar> 
	  </target>
	  <target name="create-module-jar"
	  	      description="creates the module jar file"
	  	      depends="prepare">
	  	
	  	<antcall target="create-jar"/>
	  </target>
		
	  <target name="clean" description="clean automatically created resources">
	  	<delete dir="${dist}"/>
	  </target>
		
	  <target name="apidocs"
		     description="updates the javadocs">
	  	
		  <path id="javadoc-lib">
			<fileset dir="lib/">
			  <include name="*.jar" />
			</fileset>
			<fileset dir="build/antlib/">
			  <include name="*.jar" />
			</fileset>
	   	  </path>
	  	
		  <delete dir="docs/api"/>
	  	  <mkdir dir="docs/api"/>
		  <javadoc
		           destdir="docs/api"
		  		   classpathref="javadoc-lib"
		           author="true"
		           version="false"
		           use="true"
		           windowtitle="Choosel API"
		  		   private="true">

		  	<!-- 
		  	  TODO check this - including the server causes problems because the classpath does
		  	  not contain the required annotation classes
		  	-->
		    <packageset dir="src" defaultexcludes="yes">
		      <include name="org/thechiselgroup/choosel/core/client/**"/>
		    </packageset>

		    <doctitle><![CDATA[<h1>Choosel API Documentation</h1>]]></doctitle>
		    <bottom><![CDATA[(C) <a href="http://code.google.com/p/choosel/">Choosel Project</a> 2010]]></bottom>
		    <link href="http://download.oracle.com/javase/6/docs/api/"/>
		    <link href="http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/index.html"/>
		  </javadoc>
	  </target>	
	
	  <target name="prepare"
	  	      description="create folders required for build"
	          depends="clean">
	    <mkdir dir="${dist}"/>
	  </target>
		
</project>